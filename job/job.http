@base = http://127.0.0.1:8000
@token = <PUT_YOUR_JWT_ACCESS_TOKEN_HERE>
@job_id = 345
@offer_id = 123
@unit_req_id = 777
@payment_intent_id = pi_123
@service_id = 12

###
# Create Job (JSON)
POST {{base}}/jobs/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Fix kitchen sink",
  "description": "Pipe leaking",
  "service": {{service_id}},
  "start_date": "2025-10-12",
  "start_time": "14:30:00",
  "address": {
    "street_number": "123",
    "street_name": "Main St",
    "unit_suite": "3A",
    "city_name": "Toronto",
    "province_name": "Ontario",
    "country_name": "Canada",
    "postal_code": "M5V3L9"
  },
  "job_service_types": [
    { "service_type_id": 101 },
    { "service_type_id": 102 }
  ]
}

###
# Create Job (multipart form with attachments)
POST {{base}}/jobs/
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Fix kitchen sink
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="description"

Pipe leaking under sink
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="service"

{{service_id}}
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="start_date"

2025-10-15
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="start_time"

14:30:00
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[street_number]"

123
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[street_name]"

Main St
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[unit_suite]"

3A
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[city_name]"

Toronto
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[province_name]"

Ontario
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[country_name]"

Canada
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="address[postal_code]"

M5V3L9
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="job_service_types[0][service_type_id]"

101
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="job_service_types[1][service_type_id]"

102
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="job_attachments"; filename="photo.jpg"
Content-Type: image/jpeg

< ./photo.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

###
# List My Jobs (filters optional)
GET {{base}}/jobs/list/?status=pending,in_progress&service={{service_id}}&service_types=101,102&city=Toronto&province=ON&is_paid=true&ordering=-created_at
Authorization: Bearer {{token}}

###
# Get Job Detail
GET {{base}}/jobs/{{job_id}}/
Authorization: Bearer {{token}}

###
# Update Job (PATCH partial)
PATCH {{base}}/jobs/{{job_id}}/update/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Fix kitchen sink - urgent",
  "description": "Pipe burst",
  "start_date": "2025-10-13",
  "start_time": "16:00:00",
  "address": {
    "street_number": "456",
    "street_name": "Queen St",
    "city_name": "Toronto",
    "province_name": "Ontario",
    "country_name": "Canada",
    "postal_code": "M5V1L9"
  },
  "job_service_types": [
    { "service_type_id": 101 }
  ]
}

###
# Delete Job (only if not paid and not in_progress/completed)
DELETE {{base}}/jobs/{{job_id}}/delete/
Authorization: Bearer {{token}}

###
# Payment: Create Payment Sheet (Stripe)
POST {{base}}/payment-sheet/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "job_id": {{job_id}}
}

###
# Payment: Confirm Success (marks paid_amount etc.)
POST {{base}}/payment-success/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "payment_intent_id": "{{payment_intent_id}}",
  "job_id": {{job_id}},
  "amount_paid": "25.00"
}

###
# Complete Job (creates/updates ProfessionalPayout)
POST {{base}}/jobs/{{job_id}}/complete/
Authorization: Bearer {{token}}

###
# Cancel Job (only if unassigned, unpaid, not in_progress/completed)
POST {{base}}/jobs/{{job_id}}/cancel/
Authorization: Bearer {{token}}

###
# Owner: List Unit Update Requests
GET {{base}}/jobs/unit-update-requests/owner/?status=pending,accepted&job={{job_id}}
Authorization: Bearer {{token}}

###
# Pro: List My Unit Update Requests
GET {{base}}/jobs/unit-update-requests/pro/?status=pending,rejected
Authorization: Bearer {{token}}

###
# Create Unit Update Request (Pro only)
POST {{base}}/jobs/unit-update-requests/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "job_id": {{job_id}},
  "new_unit_qty": "3.5"
}

###
# Accept Unit Update Request (Owner)
POST {{base}}/jobs/unit-update-requests/{{unit_req_id}}/accept/
Authorization: Bearer {{token}}

###
# Reject Unit Update Request (Owner)
POST {{base}}/jobs/unit-update-requests/{{unit_req_id}}/reject/
Authorization: Bearer {{token}}

###
# Pro: List Offers sent to me
GET {{base}}/offers/?status=sent,viewed
Authorization: Bearer {{token}}

###
# Pro: Accept Offer (assign job)
POST {{base}}/offers/{{offer_id}}/accept/
Authorization: Bearer {{token}}

###
# Pro: List My Assigned Jobs (filters optional)
GET {{base}}/pro/jobs/list/?status=in_progress&ordering=-created_at
Authorization: Bearer {{token}}

###
# Pro: Get Assigned Job Detail
GET {{base}}/pro/jobs/{{job_id}}/
Authorization: Bearer {{token}}

###
# Job Attachments (owner or assigned pro)
GET {{base}}/jobs/{{job_id}}/attachments/
Authorization: Bearer {{token}}

###
# Job Service Types (owner or assigned pro)
GET {{base}}/jobs/{{job_id}}/service-types/
Authorization: Bearer {{token}}

###
# Job Address (owner or assigned pro)
GET {{base}}/jobs/{{job_id}}/address/
Authorization: Bearer {{token}}

###
# Job Ratings: Create
POST {{base}}/job-rates/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "job_id": {{job_id}},
  "rate": 5
}

###
# Job Ratings: List
GET {{base}}/job-rates/
Authorization: Bearer {{token}}

###
# Job Ratings: Retrieve
GET {{base}}/job-rates/1/
Authorization: Bearer {{token}}

###
# Job Ratings: Update
PATCH {{base}}/job-rates/1/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "rate": 4
}

###
# Job Ratings: Delete
DELETE {{base}}/job-rates/1/
Authorization: Bearer {{token}}
