@base = http://127.0.0.1:8000/user
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzYzMjc1MjcwLCJpYXQiOjE3NjA2ODMyNzAsImp0aSI6IjkzZGU2N2M2NDEzODRmNTZiODM1MjQ3NWM3ZjI2Y2VhIiwidXNlcl9pZCI6MzZ9.Lb5HAq7XjWW1Cm6TI9p8DPARzekgZjTI7_n-rXvBHmo
@refresh = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc2MzI3NTI3MCwiaWF0IjoxNzYwNjgzMjcwLCJqdGkiOiI2MjUzYzgxYjFlMjY0OGZmYjkyMjQ5MTAxN2ZmYTdjZCIsInVzZXJfaWQiOjM2fQ.isLr-W85MOcN1fT-UCEoss80U0M6_UOK9GfnKjOoADQ
@email = muzzomoteam@gmail.com
@password = subhan@Ali123
@new_password = cout@Ali123
@new_email = muzzomohelp@gmail.com
@otp = 481501
@revoke_jti = <PUT_JWT_JTI_TO_REVOKE>

###
# Register (idempotent for unverified users)
POST {{base}}/auth/register/
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

###
# Verify Email (OTP)
POST {{base}}/auth/verify-email/
Content-Type: application/json

{
  "email": "{{email}}",
  "code": "{{otp}}"
}

###
# Resend OTP (verify flow)
POST {{base}}/auth/resend-otp/
Content-Type: application/json

{
  "email": "{{email}}"
}

###
# Login (email + password)
POST {{base}}/auth/login/
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

###
# Refresh Access Token
POST {{base}}/auth/token/refresh/
Content-Type: application/json

{
  "refresh": "{{refresh}}"
}

###
# Logout (blacklist refresh)
POST {{base}}/auth/logout/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "refresh": "{{refresh}}"
}

###
# Password Reset — Request Code
POST {{base}}/auth/password-reset/request/
Content-Type: application/json

{
  "email": "{{email}}"
}

###
# Password Reset — Confirm (use OTP)
POST {{base}}/auth/password-reset/confirm/
Content-Type: application/json

{
  "email": "{{email}}",
  "code": "{{otp}}",
  "new_password": "{{new_password}}"
}

###
# Password Reset — Resend OTP
POST {{base}}/auth/password-reset/resend-otp/
Content-Type: application/json

{
  "email": "{{email}}"
}

###
# Password Change (authenticated)
POST {{base}}/auth/password/change/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "current_password": "{{password}}",
  "new_password": "{{new_password}}"
}

###
# Email Update — Request (send code to new email)
POST {{base}}/auth/email-update/request/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "new_email": "{{new_email}}"
}

###
# Email Update — Confirm (verify with OTP sent to new email)
POST {{base}}/auth/email-update/confirm/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "code": "{{otp}}"
}

###
# Email Update — Resend OTP
POST {{base}}/auth/email-update/resend-otp/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "email": "{{new_email}}"
}

###
# Profile — Upload/Replace Image
# Use REST Client's file upload syntax: < /absolute/path/to/file
POST {{base}}/auth/profile/image/
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=BOUND

--BOUND
Content-Disposition: form-data; name="profile_image"; filename="avatar.png"
Content-Type: image/png

< /absolute/path/to/avatar.png
--BOUND--

###
# Profile — Basic fields (first/last/phone) - PATCH
PATCH {{base}}/auth/profile/basic/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "first_name": "Amin",
  "last_name": "Nasiri",
  "phone_number": "+359888123456"
}

###
# Me — Get current user
GET {{base}}/me/
Authorization: Bearer {{token}}

###
# Account — Deactivate
POST {{base}}/account/deactivate/
Authorization: Bearer {{token}}

POST {{base}}account/reactivate/request/
Content-Type: application/json

{
  "email": "{{email}}"
}

POST {{base}}/account/reactivate/confirm/
Content-Type: application/json

{
  "email": "{{email}}",
  "code": "{{otp}}"
}

###
# Sessions — List outstanding refresh tokens
GET {{base}}/sessions/
Authorization: Bearer {{token}}

###
# Sessions — Revoke one refresh token by JTI
POST {{base}}/sessions/revoke/
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "jti": "{{revoke_jti}}"
}


POST {{base}}/auth/unlock/request/
Content-Type: application/json

{
  "email": "{{email}}"
}


POST {{base}}/auth/unlock/confirm/
Content-Type: application/json

{
  "email": "{{email}}",
  "code": "{{otp}}"
}
